<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paiement et Livraison - Air Supplier</title>
<style>
body { font-family: 'Montserrat', sans-serif; background-color: #f8f8ff; margin:0; padding:0; color:#222; display:flex; flex-direction:column; align-items:center; }
h1 { color: #4b0082; margin-top:30px; }
.container { background: rgba(255,255,255,0.95); padding:30px; margin-top:30px; border-radius:15px; box-shadow:0 0 10px rgba(0,0,0,0.2); width:90%; max-width:600px; }
.recap { margin-bottom:25px; }
.recap p { font-size:1.1rem; }
form { margin-top:15px; background:#f4f4ff; padding:20px; border-radius:10px;}
form label { display:block; margin-top:10px; font-weight:bold; }
form input { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
form button { margin-top:15px; background-color:#6a0dad; color:#fff; padding:10px; border:none; border-radius:5px; cursor:pointer; width:100%; }
form button:hover { background-color:#4b007a; }
.warning { margin-top:20px; color:red; font-weight:bold; }
</style>
</head>
<body>

<h1>Commande et Livraison</h1>
<div class="container">

  <!-- R√©capitulatif -->
  <div class="recap">
    <h2>R√©capitulatif de votre commande</h2>
    <p><strong>Produit :</strong> <span id="item_name"></span></p>
    <p><strong>Quantit√© :</strong> <span id="quantity"></span></p>
    <p><strong>Total :</strong> <span id="price"></span> ‚Ç¨</p>
  </div>

  <div class="warning">
    ‚ö†Ô∏è Attention : Toute erreur de montant ou de destinataire n'est pas de notre responsabilit√©.
  </div>

  <!-- Formulaire de livraison et paiement -->
  <form id="orderForm">
    <h3>Informations de livraison</h3>
    <label for="fullname">Nom et pr√©nom :</label>
    <input type="text" id="fullname" name="fullname" placeholder="Jean Dupont" required>

    <label for="email">Adresse email :</label>
    <input type="email" id="email" name="email" placeholder="exemple@domaine.com" required>

    <label for="address">Adresse :</label>
    <input type="text" id="address" name="address" placeholder="123 rue Exemple" required>

    <label for="city">Ville :</label>
    <input type="text" id="city" name="city" placeholder="Paris" required>

    <label for="zipcode">Code postal :</label>
    <input type="text" id="zipcode" name="zipcode" placeholder="75001" required>

    <label for="country">Pays :</label>
    <input type="text" id="country" name="country" placeholder="France" required>

    <button type="submit">Envoyer la commande</button>
  </form>

</div>

<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
emailjs.init("bPWY-DzVkc52MNlE0"); // Ta cl√© publique

// R√©cup√©ration des param√®tres URL
const params = new URLSearchParams(window.location.search);
const item_name = params.get('item_name') || 'Produit';
const quantity = params.get('quantity') || '1';
const price = params.get('price') || '0.00';

document.getElementById('item_name').textContent = item_name;
document.getElementById('quantity').textContent = quantity;
document.getElementById('price').textContent = price;

const orderForm = document.getElementById('orderForm');

orderForm.addEventListener('submit', function(e) {
  e.preventDefault();

  // R√©cup√©ration des valeurs du formulaire
  const fullname = document.getElementById('fullname').value;
  const email = document.getElementById('email').value;
  const address = document.getElementById('address').value;
  const city = document.getElementById('city').value;
  const zipcode = document.getElementById('zipcode').value;
  const country = document.getElementById('country').value;

  // üîπ Email √† toi (Admin)
  const adminParams = {
    to_email: "romaincoynel83@gmail.com",
    fullname, email, address, city, zipcode, country,
    item_name, quantity, price
  };

  // üîπ Email de confirmation au client
  const customerParams = {
    to_email: email,
    fullname, address, city, zipcode, country,
    item_name, quantity, price
  };

  // üîπ Remplacer par vos vrais IDs EmailJS
  const serviceID = "service_id";  
  const templateAdmin = "template_admin";  
  const templateClient = "template_client";  

  // Envoi √† l'admin
  emailjs.send(serviceID, templateAdmin, adminParams)
    .then(() => {
      // Envoi au client
      return emailjs.send(serviceID, templateClient, customerParams);
    })
    .then(() => {
      alert("Commande envoy√©e ! Un email de confirmation a √©t√© envoy√© au client.");
      orderForm.reset();
    })
    .catch(err => {
      alert("Erreur lors de l'envoi de la commande. Veuillez r√©essayer.");
      console.error(err);
    });

});
</script>
</body>
</html>
